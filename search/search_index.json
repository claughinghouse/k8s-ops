{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"K8s Home Cluster \u00b6 Work in progress This repo is a work in progress. My home Kubernetes cluster \u00b6 This repository serves as the declarative state of my home Kubernetes cluster. Within my cluster Flux is deployed with Ansible and syncs the cluster state against the cluster directory . Come across any issues? Let me know by opening an issue here . Feeling like you could implement something better? Do it! Be sure to open a PR with your changes! GitHub Actions Workflow Statuses","title":"Introduction"},{"location":"#k8s-home-cluster","text":"Work in progress This repo is a work in progress.","title":"K8s Home Cluster"},{"location":"#my-home-kubernetes-cluster","text":"This repository serves as the declarative state of my home Kubernetes cluster. Within my cluster Flux is deployed with Ansible and syncs the cluster state against the cluster directory . Come across any issues? Let me know by opening an issue here . Feeling like you could implement something better? Do it! Be sure to open a PR with your changes! GitHub Actions Workflow Statuses","title":"My home Kubernetes cluster"},{"location":"docs/","text":"Build the custom image for mkdocs docker build -t squidfunk/mkdocs-material . Run the local server docker run --rm -it -p 8000:8000 -v ${PWD}:/docs squidfunk/mkdocs-material","title":"Docs"},{"location":"core-concepts/","text":"Core Concepts \u00b6 Work in progress This document is a work in progress. The basis of my home cluster are several virtual machines and some shared storage. Sounds pretty simple, right? My home cluster really does not reside at my home but rather in a colo faciltiy not far from home. Theres some trickery involved to make it behave as if the cluter were in fact at home but that is outside the scope of this repo. If you are interested in that configuration then take a look into site-to-site VPN tunnels. Everything in these docs will work the same as if your cluster is at home or remote. There are two main tools that I use to maintain my repository, Ansible and Kubernetes. Ansible is used to bootstrap the base Ubuntu 20.04 VM into a fully functioning control-plane or worker node and Kubernetes (K8s) is then used to schedule workloads on these nodes. Ansible actually deploys K8s as a task! Ansible \u00b6 Work in progress Kubernetes (coo-ber-net-ees) \u00b6 Work in progress a portable, extensible, open-source platform for managing containerized workloads and services, that facilitates both declarative configuration and automation. It has a large, rapidly growing ecosystem. Kubernetes services, support, and tools are widely available. Whew, that is a lot to take in. Let's break it down a little.","title":"Core Concepts"},{"location":"core-concepts/#core-concepts","text":"Work in progress This document is a work in progress. The basis of my home cluster are several virtual machines and some shared storage. Sounds pretty simple, right? My home cluster really does not reside at my home but rather in a colo faciltiy not far from home. Theres some trickery involved to make it behave as if the cluter were in fact at home but that is outside the scope of this repo. If you are interested in that configuration then take a look into site-to-site VPN tunnels. Everything in these docs will work the same as if your cluster is at home or remote. There are two main tools that I use to maintain my repository, Ansible and Kubernetes. Ansible is used to bootstrap the base Ubuntu 20.04 VM into a fully functioning control-plane or worker node and Kubernetes (K8s) is then used to schedule workloads on these nodes. Ansible actually deploys K8s as a task!","title":"Core Concepts"},{"location":"core-concepts/#ansible","text":"Work in progress","title":"Ansible"},{"location":"core-concepts/#kubernetes-coo-ber-net-ees","text":"Work in progress a portable, extensible, open-source platform for managing containerized workloads and services, that facilitates both declarative configuration and automation. It has a large, rapidly growing ecosystem. Kubernetes services, support, and tools are widely available. Whew, that is a lot to take in. Let's break it down a little.","title":"Kubernetes (coo-ber-net-ees)"},{"location":"get-started/ansible/","text":"Ansible \u00b6 Work in progress This document is a work in progress. Ansible is the configuration management tool that I use to ensure manange the nodes state within the cluster. When setting the cluster up for the first time Ansible is responsible for taking a freshly installed VM and turning it into either a master or worker node depending on its designation in the inventory file. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 --- all : children : master-nodes : hosts : k8s-master-1 : k8s-master-2 : k8s-master-3 : worker-nodes : hosts : k8s-worker-1 : k8s-worker-2 : k8s-worker-3 : k8s-worker-4 : k8s-worker-5 : Above is a sample of inventory that can be adjusted as needed. If changing the number of nodes be sure to keep the master nodes at an odd count to prevent quorum conflicts. Chaning the names of the nodes means that the host_vars filenames need to be updated to match. The same applies to the all.children.master-nodes and all.children.worker-nodes group_vars folder names also need to be changed. Galaxy \u00b6 Ansible Galaxy provides pre-packaged units of work known to Ansible as roles and collections. There are a few different Galaxy roles and collections that are used to deploy this cluster. Galaxy comes installed when installing Ansible. The list of requirements to be installed bt Galaxy are listed in the requirements.yaml file and can be installed by running the ansible-galaxy install command. 1 ansible-galaxy install -r requirements.yaml Once the Galaxy roles and collections are installed they can be used in the playbooks by Ansible. Ansible Configuration \u00b6 Ansible needs the ability to SSH into each host in the inventory list. Along with that it will need to be able to run tasks as an elevated user via sudo for any task that has the become: true argument. For this environment the hosts are built from a customized Ubuntu 20.04 ISO which already contains the Ansible user, password, SSH keys, and is able to sudo without password. More on that in another section on the iso build process. Next Steps \u00b6 If everything above went well, move to the next section using the navigation at the bottom of the page.","title":"Ansible"},{"location":"get-started/ansible/#ansible","text":"Work in progress This document is a work in progress. Ansible is the configuration management tool that I use to ensure manange the nodes state within the cluster. When setting the cluster up for the first time Ansible is responsible for taking a freshly installed VM and turning it into either a master or worker node depending on its designation in the inventory file. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 --- all : children : master-nodes : hosts : k8s-master-1 : k8s-master-2 : k8s-master-3 : worker-nodes : hosts : k8s-worker-1 : k8s-worker-2 : k8s-worker-3 : k8s-worker-4 : k8s-worker-5 : Above is a sample of inventory that can be adjusted as needed. If changing the number of nodes be sure to keep the master nodes at an odd count to prevent quorum conflicts. Chaning the names of the nodes means that the host_vars filenames need to be updated to match. The same applies to the all.children.master-nodes and all.children.worker-nodes group_vars folder names also need to be changed.","title":"Ansible"},{"location":"get-started/ansible/#galaxy","text":"Ansible Galaxy provides pre-packaged units of work known to Ansible as roles and collections. There are a few different Galaxy roles and collections that are used to deploy this cluster. Galaxy comes installed when installing Ansible. The list of requirements to be installed bt Galaxy are listed in the requirements.yaml file and can be installed by running the ansible-galaxy install command. 1 ansible-galaxy install -r requirements.yaml Once the Galaxy roles and collections are installed they can be used in the playbooks by Ansible.","title":"Galaxy"},{"location":"get-started/ansible/#ansible-configuration","text":"Ansible needs the ability to SSH into each host in the inventory list. Along with that it will need to be able to run tasks as an elevated user via sudo for any task that has the become: true argument. For this environment the hosts are built from a customized Ubuntu 20.04 ISO which already contains the Ansible user, password, SSH keys, and is able to sudo without password. More on that in another section on the iso build process.","title":"Ansible Configuration"},{"location":"get-started/ansible/#next-steps","text":"If everything above went well, move to the next section using the navigation at the bottom of the page.","title":"Next Steps"},{"location":"get-started/direnv/","text":"Getting Started \u00b6 Work in progress This document is a work in progress.","title":"Direnv"},{"location":"get-started/direnv/#getting-started","text":"Work in progress This document is a work in progress.","title":"Getting Started"},{"location":"get-started/docker/","text":"Getting Started \u00b6 Work in progress This document is a work in progress.","title":"Docker"},{"location":"get-started/docker/#getting-started","text":"Work in progress This document is a work in progress.","title":"Getting Started"},{"location":"get-started/environment/","text":"Environment \u00b6 In order to get started we need a few packages installed and setup. This guide assumes that HomeBrew is already installed and you are working from a macOS machine. These packages and steps may need to be adapted slightly for your environment. Warning As with any guide on the internet these packages and steps may need to be adapted slightly for your environment. Using HomeBrew on MacOS install the following packages: Ansible \u00b6 1 brew install ansible Direnv \u00b6 1 brew install direnv Docker \u00b6 1 brew install --cask docker Fluxv2 \u00b6 1 brew install fluxcd/tap/flux Git \u00b6 1 brew install git Go \u00b6 1 brew install go Helm \u00b6 1 brew install helm jq \u00b6 1 brew install jq Kubectl \u00b6 1 brew install kubectl Kubetail \u00b6 1 2 brew tap johanhaleby/kubetail brew install kubetail Mozilla SOPs \u00b6 1 brew install sops Pre-commit \u00b6 1 brew install pre-commit Shellcheck \u00b6 1 brew install shellcheck Go-Task \u00b6 1 brew install go-task/tap/go-task VS Code \u00b6 TODO \u00b6 Yamllint \u00b6 1 brew install yamllint Next Steps \u00b6 If everything above went well, move to the next section using the navigation at the bottom of the page.","title":"Environment"},{"location":"get-started/environment/#environment","text":"In order to get started we need a few packages installed and setup. This guide assumes that HomeBrew is already installed and you are working from a macOS machine. These packages and steps may need to be adapted slightly for your environment. Warning As with any guide on the internet these packages and steps may need to be adapted slightly for your environment. Using HomeBrew on MacOS install the following packages:","title":"Environment"},{"location":"get-started/environment/#ansible","text":"1 brew install ansible","title":"Ansible"},{"location":"get-started/environment/#direnv","text":"1 brew install direnv","title":"Direnv"},{"location":"get-started/environment/#docker","text":"1 brew install --cask docker","title":"Docker"},{"location":"get-started/environment/#fluxv2","text":"1 brew install fluxcd/tap/flux","title":"Fluxv2"},{"location":"get-started/environment/#git","text":"1 brew install git","title":"Git"},{"location":"get-started/environment/#go","text":"1 brew install go","title":"Go"},{"location":"get-started/environment/#helm","text":"1 brew install helm","title":"Helm"},{"location":"get-started/environment/#jq","text":"1 brew install jq","title":"jq"},{"location":"get-started/environment/#kubectl","text":"1 brew install kubectl","title":"Kubectl"},{"location":"get-started/environment/#kubetail","text":"1 2 brew tap johanhaleby/kubetail brew install kubetail","title":"Kubetail"},{"location":"get-started/environment/#mozilla-sops","text":"1 brew install sops","title":"Mozilla SOPs"},{"location":"get-started/environment/#pre-commit","text":"1 brew install pre-commit","title":"Pre-commit"},{"location":"get-started/environment/#shellcheck","text":"1 brew install shellcheck","title":"Shellcheck"},{"location":"get-started/environment/#go-task","text":"1 brew install go-task/tap/go-task","title":"Go-Task"},{"location":"get-started/environment/#vs-code","text":"","title":"VS Code"},{"location":"get-started/environment/#todo","text":"","title":"TODO"},{"location":"get-started/environment/#yamllint","text":"1 brew install yamllint","title":"Yamllint"},{"location":"get-started/environment/#next-steps","text":"If everything above went well, move to the next section using the navigation at the bottom of the page.","title":"Next Steps"},{"location":"get-started/fluxv2/","text":"Getting Started \u00b6 Work in progress This document is a work in progress.","title":"Flux"},{"location":"get-started/fluxv2/#getting-started","text":"Work in progress This document is a work in progress.","title":"Getting Started"},{"location":"get-started/git/","text":"Getting Started \u00b6 Work in progress This document is a work in progress.","title":"Git"},{"location":"get-started/git/#getting-started","text":"Work in progress This document is a work in progress.","title":"Getting Started"},{"location":"get-started/go-task/","text":"Getting Started \u00b6 Work in progress This document is a work in progress.","title":"Go-Task"},{"location":"get-started/go-task/#getting-started","text":"Work in progress This document is a work in progress.","title":"Getting Started"},{"location":"get-started/go/","text":"Getting Started \u00b6 Work in progress This document is a work in progress.","title":"Go"},{"location":"get-started/go/#getting-started","text":"Work in progress This document is a work in progress.","title":"Getting Started"},{"location":"get-started/helm/","text":"Getting Started \u00b6 Work in progress This document is a work in progress.","title":"Helm"},{"location":"get-started/helm/#getting-started","text":"Work in progress This document is a work in progress.","title":"Getting Started"},{"location":"get-started/jq/","text":"Getting Started \u00b6 Work in progress This document is a work in progress.","title":"jq"},{"location":"get-started/jq/#getting-started","text":"Work in progress This document is a work in progress.","title":"Getting Started"},{"location":"get-started/kubectl/","text":"Getting Started \u00b6 Work in progress This document is a work in progress.","title":"Kubectl"},{"location":"get-started/kubectl/#getting-started","text":"Work in progress This document is a work in progress.","title":"Getting Started"},{"location":"get-started/kubetail/","text":"Getting Started \u00b6 Work in progress This document is a work in progress.","title":"Kubetail"},{"location":"get-started/kubetail/#getting-started","text":"Work in progress This document is a work in progress.","title":"Getting Started"},{"location":"get-started/pre-commit/","text":"Getting Started \u00b6 Work in progress This document is a work in progress.","title":"Pre-commit"},{"location":"get-started/pre-commit/#getting-started","text":"Work in progress This document is a work in progress.","title":"Getting Started"},{"location":"get-started/shellcheck/","text":"Getting Started \u00b6 Work in progress This document is a work in progress.","title":"Shellcheck"},{"location":"get-started/shellcheck/#getting-started","text":"Work in progress This document is a work in progress.","title":"Getting Started"},{"location":"get-started/sops/","text":"Getting Started \u00b6 Work in progress This document is a work in progress.","title":"SOPS"},{"location":"get-started/sops/#getting-started","text":"Work in progress This document is a work in progress.","title":"Getting Started"},{"location":"get-started/vs-code/","text":"","title":"VS Code"},{"location":"get-started/yamllint/","text":"Getting Started \u00b6 Work in progress This document is a work in progress.","title":"Yamllint"},{"location":"get-started/yamllint/#getting-started","text":"Work in progress This document is a work in progress.","title":"Getting Started"}]}